(()=>{var e={942:(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function i(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=o(e,s(n)))}return e}function s(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return i.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=o(t,n));return t}function o(e,t){return t?e?e+" "+t:e+t:e}e.exports?(i.default=i,e.exports=i):void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{CompositeEntitiesByKind:()=>_,ControlOption:()=>p,ImmutableRecord:()=>h,PluralSelectControl:()=>P,PresetEntitiesByKind:()=>k,RadioControl:()=>D,SearchControl:()=>R,Set:()=>o,SingularSelectControl:()=>U,ToggleControl:()=>L,convertEntitiesToControlOptions:()=>E,createSearchEntitiesOptions:()=>v,isControlOption:()=>H,orderSelectedOptionsAtTheTop:()=>T,searchEntities:()=>c,searchEntitiesOptions:()=>m,uniqueControlOptions:()=>y,useEntityRecords:()=>V,useQueryViewablePostTypes:()=>$,useQueryViewableTaxonomies:()=>M,useSearch:()=>S});const e=window.wp.hooks,t=new class{controllers=new Map;has(e){return this.controllers.has(e.context())}add(e){const t=e.context();return this.controller(t)?.abort(),this.set(e),this.controller(t)}delete(e){this.controllers.delete(e.context())}set(e){this.controllers.set(e.context(),e)}controller(e){return this.controllers.get(e)}};class i{#e;#t;#n;constructor(e,t){if(""===e)throw new Error("Abort Controllers, context cannot be empty");this.#e=new AbortController,this.#t=e,this.#n=t}context(){return this.#t}abort(){return this.#e.abort(this.reason()),this}signal(){return this.#e.signal}isAborted(){return this.#e.signal.aborted}reason(){return new DOMException(this.#n,"AbortError")}}const s=window.lodash;class o{#r;constructor(e=[]){this.#r=this.ensureUniqueness(e)}add(e){return this.has(e)?this:new o([...this.#r,e])}delete(e){return this.has(e)?new o(this.#r.filter((t=>!this.isEqual(t,e)))):this}has(e){return this._has(e,this.#r)}map(e){return new o(this.#r.map(e))}toArray(){return Object.freeze([...this.#r])}forEach(e){this.#r.forEach(e)}length(){return this.#r.length}concat(e){return new o([...this.#r,...e.toArray()])}filter(e){return new o(this.#r.filter(e))}find(e){return this.#r.slice(0).find(e)}first(){return this.#r.slice(0)[0]}last(){return this.#r.slice(-1)[0]}copy(e,t){return new o(this.#r.slice(e,t))}equals(e){if(this.length()!==e.length())return!1;if(this===e)return!0;for(const t of this)if(!e.has(t))return!1;return!0}*[Symbol.iterator](){for(const e of this.#r)yield e}isEqual(e,t){return(0,s.isEqual)(e,t)}_has(e,t){return t.some((t=>this.isEqual(t,e)))}ensureUniqueness(e){return e.reduce(((e,t)=>(this._has(t,e)||e.push(t),e)),[])}}const a=window.wp.apiFetch,l=n.n(a)();async function c(n,r,s,a){var c,d,h;const{exclude:p,include:E,fields:m=["title","id"],...v}=null!=a?a:{},g=new URLSearchParams({per_page:"10",order:"DESC",orderBy:"title",...{exclude:null!==(c=p?.toArray())&&void 0!==c?c:[],include:null!==(d=E?.toArray())&&void 0!==d?d:[],...v},type:n,search:s,subtype:r.toArray(),_fields:u(m)}).toString(),w=t.add(new i(g,`Request aborted with parameters: ${g}`)),f=await l({path:`?rest_route=/wp/v2/search&${g}`,signal:null!==(h=w?.signal())&&void 0!==h?h:null}).catch((t=>{throw t instanceof DOMException&&"AbortError"===t.name&&(0,e.doAction)("wp-entities-search.on-search.abort",t),t}));return new o(f)}function u(e){return e.join(",")}function d(e,t){if(!e)throw new Error(t)}class h{#i={};constructor(e={}){this.#i=e}get(e,t){var n;return null!==(n=this.#i[e])&&void 0!==n?n:t}set(e,t){return new h({...this.#i,[e]:t})}}class p{constructor(e,t,n=new h){d(""!==e,"ControlOption: Label must be a non empty string."),d(""!==t,"ControlOption: Value must be a non empty string."),this.label=e,this.value=t,this.extra=n}}function E(e,t,n,...r){return e.map((e=>{const i=e[t],s=e[n];d("string"==typeof i,"Label key must be a string");const o=r.reduce(((t,n)=>({...t,[n]:e[n]})),{});return new p(i,s,new h(o))}))}async function m(e,t,n,r){const i=await c(e,n,t,r),{fields:s=[]}=null!=r?r:{},[o="title",a="id",...l]=s;return E(i,o,a,...l)}function v(e){return async(t,n,r)=>m(e,t,n,r)}const g=window.React;var w=n.n(g);function f(e,t){switch(t.type){case"UPDATE_ENTITIES":return{...e,entities:t.entities};case"UPDATE_KIND":return{...e,kind:t.kind};case"UPDATE_CURRENT_ENTITIES_OPTIONS":return{...e,currentEntitiesOptions:t.currentEntitiesOptions};case"UPDATE_SELECTED_ENTITIES_OPTIONS":return{...e,selectedEntitiesOptions:t.selectedEntitiesOptions,entities:t.selectedEntitiesOptions.map((e=>e.value))};case"CLEAN_ENTITIES_OPTIONS":return{...e,selectedEntitiesOptions:new o,currentEntitiesOptions:new o};case"UPDATE_ENTITIES_OPTIONS_FOR_NEW_KIND":return{...e,currentEntitiesOptions:t.entitiesOptions,selectedEntitiesOptions:new o,entities:new o,kind:t.kind};case"UPDATE_SEARCH_PHRASE":return{...e,searchPhrase:t.searchPhrase};default:return e}}const O=window.wp.compose;function S(t,n,r,i){return(0,O.useThrottle)((s=>{const a=("string"==typeof(l=s)?l:l.target.value).trim();var l;t(a,n,{exclude:r}).then((e=>i({type:"UPDATE_CURRENT_ENTITIES_OPTIONS",currentEntitiesOptions:e}))).catch((t=>{(0,e.doAction)("wp-entities-search.on-search.error",t);const n=new o;return i({type:"UPDATE_CURRENT_ENTITIES_OPTIONS",currentEntitiesOptions:n}),n})).finally((()=>i({type:"UPDATE_SEARCH_PHRASE",searchPhrase:a})))}),300,{leading:!1,trailing:!0})}function T(e,t){if(e.length()<=0)return e;if(void 0===t||t.length()<=0)return e;let n=new o,r=new o;return e.forEach((e=>{t.has(e.value)?n=n.add(e):r=r.add(e)})),n.concat(r)}function y(e){let t=new o;const n=[];for(const r of e)n.includes(r.value)||(t=t.add(r)),n.push(r.value);return t}function _(t){const[n,r]=function(t,n){const[r,i]=(0,g.useReducer)(f,function(e){return{entities:new o([]),kind:new o([]),currentEntitiesOptions:new o,selectedEntitiesOptions:new o,searchPhrase:"",...e}}(t));return(0,g.useEffect)((()=>{Promise.all([n("",r.kind,{exclude:r.entities}),r.entities.length()>0?n("",r.kind,{include:r.entities,per_page:"-1"}):void 0]).then((e=>{var t,n;const r=null!==(t=e[0])&&void 0!==t?t:new o,s=null!==(n=e[1])&&void 0!==n?n:new o;i({type:"UPDATE_SELECTED_ENTITIES_OPTIONS",selectedEntitiesOptions:s}),i({type:"UPDATE_CURRENT_ENTITIES_OPTIONS",currentEntitiesOptions:r})})).catch((t=>{(0,e.doAction)("wp-entities-search.on-storage-initialization.error",t)}))}),[]),[r,i]}({entities:t.entities.value,kind:t.kind.value},t.searchEntities),i=S(t.searchEntities,n.kind,n.entities,r),s={...t.entities,value:n.entities,options:T(y(n.selectedEntitiesOptions.concat(n.currentEntitiesOptions)),n.entities),onChange:i=>{t.entities.onChange(i),i.length()<=0?r({type:"UPDATE_SELECTED_ENTITIES_OPTIONS",selectedEntitiesOptions:new o}):Promise.all([t.searchEntities(n.searchPhrase,n.kind,{exclude:i}),t.searchEntities("",n.kind,{include:i,per_page:"-1"})]).then((e=>{var t,n;const i=null!==(t=e[0])&&void 0!==t?t:new o,s=null!==(n=e[1])&&void 0!==n?n:new o;r({type:"UPDATE_SELECTED_ENTITIES_OPTIONS",selectedEntitiesOptions:s}),r({type:"UPDATE_CURRENT_ENTITIES_OPTIONS",currentEntitiesOptions:i})})).catch((t=>{(0,e.doAction)("wp-entities-search.on-change-entities.error",t)}))}},a={...t.kind,value:n.kind,onChange:i=>{const s=new o;if(t.kind.onChange(i),t.entities.onChange(s),i.length()<=0)return r({type:"CLEAN_ENTITIES_OPTIONS"}),void r({type:"UPDATE_KIND",kind:i});t.searchEntities(n.searchPhrase,i,{exclude:n.entities}).then((e=>{r({type:"UPDATE_ENTITIES_OPTIONS_FOR_NEW_KIND",entitiesOptions:e,kind:i})})).catch((t=>{r({type:"CLEAN_ENTITIES_OPTIONS"}),(0,e.doAction)("wp-entities-search.on-change-kind.error",t)}))}};return(0,g.createElement)(g.Fragment,null,t.children(s,a,i))}var C=n(942),N=n.n(C);const b=window.wp.i18n;function I(){return(0,g.createElement)("p",{className:"wes-no-option-message"},(0,b.__)("No options","wp-entities-search"))}function P(e){const[t,n]=w().useState(e.value),r=N()(e.className,"wes-select-control","wes-select-control--plural");return e.options.length()<=0?(0,g.createElement)(I,null):(0,g.createElement)("select",{multiple:!0,className:r,value:t.toArray(),onChange:t=>{t.target.selectedOptions.length<=0&&e.onChange(new o);const r=Array.from(t.target.selectedOptions).map((e=>e.value)),i=e.options.filter((e=>r.includes(String(e.value)))).map((e=>e.value));n(i),e.onChange(i)}},e.options.map((e=>(0,g.createElement)("option",{key:e.value,className:`wes-select-control-item wes-select-control-item--${e.value}`,value:e.value},e.label))))}function A(e){const t=w().useId();return null!=e?e:t}function R(e){const t=A(e.id),n=e.label||(0,b.__)("Search","wp-entities-search"),[r,i]=w().useState(""),s={type:"search",value:r,className:"wes-search-control__input",onChange:t=>{i(t.target.value),e.onChange(t.target.value)}};return(0,g.createElement)("div",{className:"wes-search-control"},(0,g.createElement)("label",{htmlFor:t},(0,g.createElement)("span",{className:"wes-search-control__label"},n),(0,g.createElement)("input",{id:t,...s})))}const k=(0,O.createHigherOrderComponent)((e=>t=>{const{kind:n,entities:r,onChangeEntities:i,kindOptions:s,onChangeKind:a,entitiesFields:l,kindComponent:c,entitiesComponent:u,entitiesFinder:d,...h}=t;var p;const E={value:r,onChange:i},m={value:"string"==typeof(p=t.kind)?new o([p]):p,options:s,onChange:a},v=function(e,t){return(n,r,i)=>{var s;return e(n,r,{...i,fields:[...null!==(s=i?.fields)&&void 0!==s?s:["title","id"],...null!=t?t:[]]})}}(d,l);return(0,g.createElement)(e,{entities:E,kind:m,entitiesFinder:v,kindComponent:c,entitiesComponent:u,...h})}),"withDataBound")((function(e){const t=N()("wes-preset-entities-by-kind",{[e.className]:!!e.className});return(0,g.createElement)("div",{className:t},(0,g.createElement)(_,{entities:e.entities,kind:e.kind,searchEntities:e.entitiesFinder},((t,n,r)=>(0,g.createElement)(g.Fragment,null,(0,g.createElement)(e.kindComponent,{...n}),(0,g.createElement)(R,{onChange:r}),(0,g.createElement)(e.entitiesComponent,{...t})))))}));function D(e){const t=N()(e.className,"wes-radio-control"),n=t=>{const{target:n}=t,r=e.options.find((e=>String(e.value)===n.value));r&&e.onChange(r.value)};return(0,g.createElement)("div",{className:t},e.options.map((t=>(0,g.createElement)(x,{key:t.value,label:t.label,value:t.value,selectedValue:e.value,onChange:n}))))}function x(e){const t=A(),n=String(e.value);return(0,g.createElement)("div",{className:`wes-radio-control-item wes-radio-control-item--${n}`},(0,g.createElement)("label",{htmlFor:t},(0,g.createElement)("input",{type:"radio",id:t,checked:e.selectedValue===e.value,value:n,onChange:e.onChange}),e.label))}function U(e){const t=N()(e.className,"wes-select-control","wes-select-control--singular");return e.options.length()<=0?(0,g.createElement)(I,null):(0,g.createElement)("select",{className:t,value:e?.value,onChange:t=>{const{target:n}=t,r=e.options.find((e=>String(e.value)===n.value));r&&e.onChange(r.value)}},e.options.map((e=>(0,g.createElement)("option",{key:e.value,className:`wes-select-control-item wes-select-control-item--${e.value}`,value:e.value},e.label))))}function L(e){const t=N()(e.className,"wes-toggle-control");if(e.options.length()<=0)return(0,g.createElement)(I,null);const n=t=>{const{target:n}=t,r=e.options.find((e=>String(e.value)===n.value));r&&(n.checked?e.onChange(e.value.add(r.value)):e.onChange(e.value.delete(r.value)))};return(0,g.createElement)("div",{className:t},e.options.map((t=>(0,g.createElement)(F,{key:t.value,label:t.label,value:t.value,selectedValues:e.value,onChange:n}))))}function F(e){const t=A(),n=String(e.value);return(0,g.createElement)("div",{className:`wes-toggle-control-item wes-toggle-control-item--${n}`},(0,g.createElement)("label",{htmlFor:t},(0,g.createElement)("input",{type:"checkbox",id:t,className:`wes-toggle-control-item__input-${n}`,checked:e.selectedValues?.has(e.value),value:n,onChange:e.onChange}),e.label))}const j=window.wp.coreData;var q=function(e){return e.ERROR="ERROR",e.SUCCESS="SUCCESS",e.RESOLVING="RESOLVING",e}(q||{});function V(e,t,n={}){const r=(0,j.useEntityRecords)(e,t,n),i=r.status;return Object.freeze({records:()=>{var e;return new o(null!==(e=r.records)&&void 0!==e?e:[])},isResolving:()=>r.isResolving&&!r.hasResolved&&i===q.RESOLVING,errored:()=>K(r,q.ERROR),succeed:()=>K(r,q.SUCCESS)})}function K(e,t){return e?.hasResolved&&e?.status===t}function $(){const e=V("root","postType",{per_page:-1}),t=e.records().filter((e=>e.viewable));return{...e,records:()=>t}}function M(){const e=V("root","taxonomy",{per_page:-1}),t=e.records().filter((e=>e.visibility.publicly_queryable));return{...e,records:()=>t}}function H(e){return null!==e&&"object"==typeof e&&"value"in e&&"label"in e&&"string"==typeof e.label}})(),window.wpEntitiesSearch=r})();